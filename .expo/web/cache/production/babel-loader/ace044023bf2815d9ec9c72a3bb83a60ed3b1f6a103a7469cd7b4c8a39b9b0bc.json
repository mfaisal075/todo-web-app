{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.useTaskContext=exports.TaskProvider=void 0;var _asyncToGenerator2=_interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));var _slicedToArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));var _react=_interopRequireWildcard(require(\"react\"));var _firestore=require(\"firebase/firestore\");var _FirebaseConfig=require(\"../../FirebaseConfig\");var _reactNative=require(\"react-native\");var _jsxRuntime=require(\"react/jsx-runtime\");function _getRequireWildcardCache(e){if(\"function\"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(\"default\"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}var TaskContext=(0,_react.createContext)(undefined);var TaskProvider=exports.TaskProvider=function TaskProvider(_ref){var children=_ref.children;var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2.default)(_useState,2),tasks=_useState2[0],setTasks=_useState2[1];var fetchTasks=function(){var _ref2=(0,_asyncToGenerator2.default)(function*(){try{var tasksArray=[];var querySnapshot=yield(0,_firestore.getDocs)((0,_firestore.collection)(_FirebaseConfig.FIRESTORE_DB,'tasks'));querySnapshot.forEach(function(doc){tasksArray.push({id:doc.id,taskName:doc.data().taskName,taskDescription:doc.data().taskDescription,dueDate:doc.data().dueDate,status:doc.data().status,createdAt:doc.data().createdAt,reasonOfDeletion:doc.data().reasonOfDeletion});});setTasks(tasksArray);}catch(error){console.log('Error fetching tasks: ',error);}});return function fetchTasks(){return _ref2.apply(this,arguments);};}();(0,_react.useEffect)(function(){fetchTasks();},[]);var deleteTask=function(){var _ref3=(0,_asyncToGenerator2.default)(function*(taskId,reason){try{var selectedTask=tasks.find(function(task){return task.id===taskId;});if(!selectedTask){_reactNative.Alert.alert('Error: Task not found');return;}var taskRef=(0,_firestore.doc)(_FirebaseConfig.FIRESTORE_DB,'tasks',taskId);yield(0,_firestore.updateDoc)(taskRef,{reasonOfDeletion:reason,status:'Deleted'});var updatedTasks=tasks.filter(function(task){return task.id!==taskId;});setTasks(updatedTasks);_reactNative.Alert.alert('Task successfully deleted with reason');}catch(error){console.error('Error deleting task: ',error.message);_reactNative.Alert.alert('Error deleting task: '+error.message);}});return function deleteTask(_x,_x2){return _ref3.apply(this,arguments);};}();var allTasksCount=tasks.filter(function(task){return task.status==='To Do'||task.status==='Doing'||task.status==='Done';}).length;var newTasksCount=tasks.filter(function(task){return task.status==='To Do';}).length;var pendingTasksCount=tasks.filter(function(task){return task.status==='To Do'||task.status==='Doing';}).length;var completedTasksCount=tasks.filter(function(task){return task.status==='Done';}).length;var deletedTasksCount=tasks.filter(function(task){return task.status==='Deleted';}).length;return(0,_jsxRuntime.jsx)(TaskContext.Provider,{value:{tasks:tasks,setTasks:setTasks,deleteTask:deleteTask,newTasksCount:newTasksCount,pendingTasksCount:pendingTasksCount,completedTasksCount:completedTasksCount,deletedTasksCount:deletedTasksCount,allTasksCount:allTasksCount,fetchTasks:fetchTasks},children:children});};var useTaskContext=exports.useTaskContext=function useTaskContext(){var context=(0,_react.useContext)(TaskContext);if(!context){throw new Error('useTaskContext must be used within a TaskProvider');}return context;};","map":{"version":3,"names":["_react","_interopRequireWildcard","require","_firestore","_FirebaseConfig","_reactNative","_jsxRuntime","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TaskContext","createContext","undefined","TaskProvider","exports","_ref","children","_useState","useState","_useState2","_slicedToArray2","tasks","setTasks","fetchTasks","_ref2","_asyncToGenerator2","tasksArray","querySnapshot","getDocs","collection","FIRESTORE_DB","forEach","doc","push","id","taskName","data","taskDescription","dueDate","status","createdAt","reasonOfDeletion","error","console","log","apply","arguments","useEffect","deleteTask","_ref3","taskId","reason","selectedTask","find","task","Alert","alert","taskRef","updateDoc","updatedTasks","filter","message","_x","_x2","allTasksCount","length","newTasksCount","pendingTasksCount","completedTasksCount","deletedTasksCount","jsx","Provider","value","useTaskContext","context","useContext","Error"],"sources":["C:/Users/Mian/Desktop/app/TodoWebApp/src/components/TaskCotext.tsx"],"sourcesContent":["import React, {useContext, createContext, useState, useEffect} from 'react';\r\nimport {Task} from './TaskIterface';\r\nimport {collection, doc, getDocs, updateDoc} from 'firebase/firestore';\r\nimport {FIRESTORE_DB} from '../../FirebaseConfig';\r\nimport {Alert} from 'react-native';\r\n\r\nconst TaskContext = createContext<TaskContextType | undefined>(undefined);\r\n\r\ninterface TaskContextType {\r\n  tasks: Task[];\r\n  setTasks: React.Dispatch<React.SetStateAction<Task[]>>;\r\n  deleteTask: (taskId: string, reason: string) => void;\r\n  allTasksCount: number;\r\n  newTasksCount: number;\r\n  pendingTasksCount: number;\r\n  completedTasksCount: number;\r\n  deletedTasksCount: number;\r\n  fetchTasks: () => Promise<void>;\r\n}\r\n\r\nexport const TaskProvider = ({children}: any) => {\r\n  const [tasks, setTasks] = useState<Task[]>([]);\r\n\r\n  const fetchTasks = async () => {\r\n    try {\r\n      const tasksArray: Task[] = [];\r\n      const querySnapshot = await getDocs(collection(FIRESTORE_DB, 'tasks'));\r\n      querySnapshot.forEach(doc => {\r\n        tasksArray.push({\r\n          id: doc.id,\r\n          taskName: doc.data().taskName, // Ensure consistency with field name\r\n          taskDescription: doc.data().taskDescription,\r\n          dueDate: doc.data().dueDate,\r\n          status: doc.data().status,\r\n          createdAt: doc.data().createdAt,\r\n          reasonOfDeletion: doc.data().reasonOfDeletion,\r\n        });\r\n      });\r\n      setTasks(tasksArray); // Set tasks state\r\n    } catch (error) {\r\n      console.log('Error fetching tasks: ', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchTasks();\r\n  }, []);\r\n\r\n  // Function to delete a task from Firestore and update local state\r\n  const deleteTask = async (taskId: string, reason: string) => {\r\n    try {\r\n      // Find the task in local state\r\n      const selectedTask = tasks.find(task => task.id === taskId);\r\n\r\n      if (!selectedTask) {\r\n        Alert.alert('Error: Task not found');\r\n        return;\r\n      }\r\n\r\n      // Update the task in Firestore with the reason for deletion and status\r\n      const taskRef = doc(FIRESTORE_DB, 'tasks', taskId);\r\n      await updateDoc(taskRef, {\r\n        reasonOfDeletion: reason,\r\n        status: 'Deleted',\r\n      });\r\n\r\n      // Remove the task from local state\r\n      const updatedTasks = tasks.filter(task => task.id !== taskId);\r\n      setTasks(updatedTasks);\r\n\r\n      Alert.alert('Task successfully deleted with reason');\r\n    } catch (error: any) {\r\n      console.error('Error deleting task: ', error.message);\r\n      Alert.alert('Error deleting task: ' + error.message);\r\n    }\r\n  };\r\n\r\n  const allTasksCount = tasks.filter(\r\n    task =>\r\n      task.status === 'To Do' ||\r\n      task.status === 'Doing' ||\r\n      task.status === 'Done',\r\n  ).length;\r\n  const newTasksCount = tasks.filter(task => task.status === 'To Do').length;\r\n  const pendingTasksCount = tasks.filter(\r\n    task => task.status === 'To Do' || task.status === 'Doing',\r\n  ).length;\r\n  const completedTasksCount = tasks.filter(\r\n    task => task.status === 'Done',\r\n  ).length;\r\n  const deletedTasksCount = tasks.filter(\r\n    task => task.status === 'Deleted',\r\n  ).length;\r\n\r\n  return (\r\n    <TaskContext.Provider\r\n      value={{\r\n        tasks,\r\n        setTasks,\r\n        deleteTask,\r\n        newTasksCount,\r\n        pendingTasksCount,\r\n        completedTasksCount,\r\n        deletedTasksCount,\r\n        allTasksCount,\r\n        fetchTasks\r\n      }}>\r\n      {children}\r\n    </TaskContext.Provider>\r\n  );\r\n};\r\n\r\n// Custom hook to use the TaskContext\r\nexport const useTaskContext = () => {\r\n  const context = useContext(TaskContext);\r\n  if (!context) {\r\n    throw new Error('useTaskContext must be used within a TaskProvider');\r\n  }\r\n  return context;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}